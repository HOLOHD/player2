<!doctype html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>piSignage Player</title><style>body{background:#000;overflow:hidden;margin:0px;padding:0px;border:none;font-size:0;height:100%;width:100%}#full{z-index:0}.zone{background:rgba(0,0,0,0);overflow:hidden;display:inline-block;margin:0px;padding:0px;border:none;font-size:0;opacity:1}.zone>img,.image-text-container>img{max-width:100%;max-height:100%;object-fit:scale-down;display:block;position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.stretched,.fill-image>img,.fill-image .image-text-container>img{width:100%;height:100%;object-fit:fill}.letterbox,.contain-image>img,.contain-image .image-text-container>img{width:100%;height:100%;object-fit:contain}.fill-video>video{width:100%;height:100%;object-fit:fill}.contain-video>video{width:100%;height:100%;object-fit:contain}.scale-down-image>img,.scale-down-image .image-text-container>img{object-fit:scale-down}.zone>iframe,.zone>.image-text-container{overflow:hidden;height:100%;width:100%;position:absolute;top:0;bottom:0;left:0;right:0}.image-text-container{visibility:hidden}.zone .text-container,.zone .image-text-container{visibility:visible !important}.text-container{display:table;height:100%;width:100%;margin:0px;padding:0px;border:none;font-size:0;position:absolute;top:0;bottom:0;left:0;right:0;visibility:hidden}.default-text-style{height:100%;width:100%;text-align:center;display:table-cell;vertical-align:middle;margin:0px;padding:5px;font-size:50px;color:#fff;white-space:pre-line}.text-on-image{color:#fff;font-size:xx-large;height:60px;line-height:60px;width:100%;margin:0px;padding:0px;border:none;position:absolute;left:0px;bottom:0px;z-index:20;background-color:rgba(0,0,0,.4);text-align:center}.relative{position:relative}.fixed{position:fixed}.absolute{position:absolute}.width-100{width:100%}.height-100{height:100%}.width-75{width:75%}.height-75{height:75%}.width-50{width:50%}.width-25{width:25%}.height-25{height:25%}.height-50{height:50%}@media(min-width: 1280px){.height-42{height:540px}}@media(min-width: 1920px){.height-42{height:810px}}@media(min-width: 2560px){.height-42{height:1075px}}@media(min-width: 3840px){.height-42{height:1620px}}@media(min-width: 720px)and (min-height: 1280px)and (orientation: portrait){.height-42{height:540px}}@media(min-width: 720px)and (min-height: 2100px)and (orientation: portrait){.height-42{height:1075px}}@media(min-width: 1080px)and (min-height: 1920px)and (orientation: portrait){.height-42{height:810px}}@media(min-width: 1080px)and (min-height: 3500px)and (orientation: portrait){.height-42{height:1620px}}@media(min-width: 2160px)and (orientation: portrait){.height-42{height:1620px}}@media(min-width: 1280px){.height-58{height:740px}}@media(min-width: 1920px){.height-58{height:1110px}}@media(min-width: 2560px){.height-58{height:1485px}}@media(min-width: 3840px){.height-58{height:2220px}}@media(min-width: 720px)and (min-height: 1280px)and (orientation: portrait){.height-58{height:740px}}@media(min-width: 720px)and (min-height: 2100px)and (orientation: portrait){.height-58{height:1485px}}@media(min-width: 1080px)and (min-height: 1920px)and (orientation: portrait){.height-58{height:1110px}}@media(min-width: 1080px)and (min-height: 3500px)and (orientation: portrait){.height-58{height:2220px}}@media(min-width: 2160px)and (orientation: portrait){.height-58{height:2220px}}.height-12-5{height:12.5%}.htwt-100{width:100% !important;height:100% !important;top:0 !important;left:0 !important}.htwt-zero{width:0px !important;height:0px !important}#ticker{display:none;color:#fff;height:60px;line-height:60px;width:100%;margin:0px;padding:0px;border:none;position:fixed;left:0;bottom:0;z-index:30;background-color:rgba(0,0,0,.4);text-align:center;overflow:hidden;white-space:nowrap;transform:translate3d(0px, 0px, 0px);font-family:sans-serif;font-size:40px}.ticker-hd{height:100px}#tickertext{display:inline-block}@media screen and (min-width: 1280px){.rotate-90{-webkit-transform:translate(280px, -280px) rotate(90deg);transform:translate(280px, -280px) rotate(90deg)}}@media screen and (min-width: 1920px){.rotate-90{-webkit-transform:translate(420px, -420px) rotate(90deg);transform:translate(420px, -420px) rotate(90deg)}}@media screen and (min-width: 1280px){.rotate-270{-webkit-transform:translate(280px, -280px) rotate(-90deg);transform:translate(280px, -280px) rotate(-90deg)}}@media screen and (min-width: 1920px){.rotate-270{-webkit-transform:translate(420px, -420px) rotate(-90deg);transform:translate(420px, -420px) rotate(-90deg)}}#clock{z-index:40;position:absolute;bottom:0;right:0;background:-webkit-radial-gradient(circle, #888888, #222222);border:none;border-radius:6px;color:#fff;font-family:sans-serif;font-weight:900;height:60px;line-height:60px;margin:0px;padding:0px 10px;text-align:center;display:none}#logo{z-index:50;position:absolute;margin:0;padding:0;top:10px;left:10px;display:none}#emessage{z-index:60;position:fixed;top:0;bottom:0;left:0;right:0;display:none;align-items:center;justify-content:center;margin:0;padding:0}#emessage>span{background-color:rgba(32,32,0,.8);padding:10px 20px;border:none;border-radius:6px;color:#fff;font-family:sans-serif}.transition-disable{transition:none;transform:none;opacity:1}.transition-enable{transition-timing-function:ease-in-out;transition-duration:1s;transition-property:opacity,transform;transform:translateZ(0)}</style></head><body><div class="zone height-100 width-100 relative" id="full"><div class="zone width-25 height-100 relative" id="side"></div><div class="zone width-75 height-100 relative" id="wrapper"><div class="zone width-100 height-25 relative" id="bottom"></div><div class="zone width-100 height-75 relative" id="main"></div></div></div><div id="ticker"><span id="tickertext"></span></div><div id="clock"></div><img id="logo"><div id="emessage"></div><h1></h1><script>(()=>{var e,t,n,o=(e,t)=>{var n=0,o=null,a=new Promise((a=>{o=a,n=setTimeout(o,e,t)}));return{get promise(){return a},cancel(){n&&(clearTimeout(n),n=0,o(-1))}}},a=e=>{e&&e.cancel&&e.cancel()},r={BROWSER_WS:[9999,9998],DISCOVERY_HTTP:8001,WEBUI_HTTP:8e3};function i(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}var l,s=function(){var o,a=(o=function*(o){var{message:a,behavior:r,textSpeed:i=3,style:l,tickerHeight:s=60}=o;a?(((i=parseInt(i))<1||i>3)&&(i=3),l&&function(e){var n=e?e.split(";"):[];for(var o of n)if(o){var a=o.split(":");a[0]&&a[1]&&(t.style[a[0].trim()]=a[1].trim())}}(l),"none"!==t.style.display&&(t.style.display="none"),t.style.display="block",function(o,a,r,i){var l,s,c,d,u;switch(cancelAnimationFrame(e),n.innerHTML=o,r){case 1:u=1;break;case 2:u=2;break;default:u=4}-1===i.toString().indexOf("px")?t.style.height=i+"px":t.style.height=i,"scroll"===a||"scrollRight"===a?(s=window.innerWidth,n.style.position="absolute",l=n.clientWidth+1,t.style.width=l+s+"px",n.style.marginTop="0px",n.style.position="","scrollRight"===a?(c=!0,d=-1*l,t.style["text-align"]="left"):(c=!1,d=s,t.style["text-align"]="left"),function t(){var o,a,r;c?(o=d<s,a=-1,r=-1*l):(o=d>-1*l,a=1,r=s),o?d-=u*a:d=r,n.style.transform="translateX("+d+"px) translateZ(0)",e=requestAnimationFrame(t)}()):(d=parseInt(t.offsetHeight),t.style["text-align"]="center",t.style.width="100%",n.style.marginLeft="0px",n.style.display="inline-block",n.style.marginTop=d+"px",function t(){d=d>u?d-u:0,n.style.marginTop=d+"px",d>0&&(e=requestAnimationFrame(t))}())}(a,r,i,s)):(t.style.display="none",cancelAnimationFrame(e))},function(){var e=this,t=arguments;return new Promise((function(n,a){var r=o.apply(e,t);function l(e){i(r,n,a,l,s,"next",e)}function s(e){i(r,n,a,l,s,"throw",e)}l(void 0)}))});return function(e){return a.apply(this,arguments)}}();function c(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){c(r,o,a,i,l,"next",e)}function l(e){c(r,o,a,i,l,"throw",e)}i(void 0)}))}}var u,p={right:{property:"transform",entryValue:"translateX(-100%)",viewValue:"translateX(0)",exitValue:"translateX(100%)"},left:{property:"transform",entryValue:"translateX(100%)",viewValue:"translateX(0)",exitValue:"translateX(-100%)"},down:{property:"transform",entryValue:"translateY(-100%)",viewValue:"translateY(0)",exitValue:"translateY(100%)"},up:{property:"transform",entryValue:"translateY(100%)",viewValue:"translateY(0)",exitValue:"translateY(-100%)"},blend:{property:"opacity",entryValue:0,viewValue:1,exitValue:0},none:{property:"opacity",entryValue:0,viewValue:1,exitValue:0}},m=["main","side","bottom","zone4","zone5","zone6"],v=[],g={animationType:"none",signageBackgroundColor:"#000",urlReloadDisable:!1,fullscreen:!1,fitImage:2,videoKeepAspect:!1,portrait:0,audioVolume:1},y={},f={},w={},h={},b={},x=[],E=null,k=()=>{for(var e of(b.full=document.getElementById("full"),b.wrapper=document.getElementById("wrapper"),b.wrapper1=document.getElementById("wrapper1"),m))b[e]=document.getElementById(e),b[e]&&v.push(e),y[e]=null,w[e]=null;E=new Audio,(()=>{var e=document.getElementById("ticker");if(!e){var o=document.createElement("div");o.innerHTML='<span id="tickertext"> </span>',o.setAttribute("id","ticker"),document.body.appendChild(o),e=o}t=e,n=document.getElementById("tickertext")})(),A(window.innerWidth,window.innerHeight)},A=function(e,t){document.body.style.height=t+"px",document.body.style.width=e+"px",b.full.style.height=t+"px"},L=e=>{for(;e.firstChild;)e.removeChild(e.firstChild)},T=()=>{var{fullscreen:e}=g;for(var t of v){var n="main"===t?"htwt-100":"htwt-zero";b[t].classList.toggle(n,e)}b.wrapper1&&b.wrapper1.classList.toggle("htwt-zero",e),b.wrapper&&b.wrapper.classList.toggle("htwt-100",e)},I=function(){var e=d((function*(e){a(w[e]);var{property:t="opacity",viewValue:n=1,exitValue:r=0}=p[g.animationType];if("none"===g.animationType&&L(b[e]),T(),b[e].appendChild(y[e]),null!==h[e]&&b[e].appendChild(h[e]),"none"!==g.animationType){a(w[e]),w[e]=o(100,e),yield w[e].promise;var i=[];y[e].style[t]=n,i.push(new Promise((t=>{y[e].addEventListener("transitionend",(()=>{t()}),{once:!0})}))),f[e]&&(f[e].style[t]=r,i.push(new Promise((t=>{f[e].addEventListener("transitionend",(()=>{t()}),{once:!0})})))),yield Promise.all(i)}f[e]&&(f[e].src="",f[e].remove(),f[e]=null),y[e]&&"VIDEO"===y[e].tagName&&y[e].play()}));return function(t){return e.apply(this,arguments)}}(),V=function(){var e=d((function*(){for(var e of x)if(y[e]){var{property:t,entryValue:n,viewValue:o}=p[g.animationType];"none"!==g.animationType?(y[e].classList.add("transition-enable"),y[e].style[t]=n):(b[e].classList.add("transition-disable"),b[e].style[t]=o),I(e)}x.length=0}));return function(){return e.apply(this,arguments)}}(),D=null,C=0,R=()=>{0===--C&&(clearTimeout(D),V())},O=(e,t,n)=>{var{type:o,path:a,text:r=null,style:i,mute:l=!1,loop:s=!1,startTime:c=0}=t,d=a||r;if(!0!==g.urlReloadDisable&&"iframe"===o){var u=-1===d.indexOf("?")?"?":"&";d="".concat(d).concat(u,"ts=").concat(Date.now())}b[e].uri=d,"none"!==g.animationType&&y[e]&&(f[e]=y[e],f[e].style.zIndex="-1"),y[e]=null,h[e]=null;var p={once:!0};switch(o){case"image":y[e]=new Image,y[e].src=d,y[e].addEventListener("load",(()=>{R()}),p);break;case"image-text":var m=document.createElement("div");m.setAttribute("class","image-text-container");var v=m.appendChild(new Image);v.src=d;var w=m.appendChild(document.createElement("div"));w.setAttribute("class","text-on-image"),w.innerHTML=r,y[e]=document.body.appendChild(m);var x=!1;v.addEventListener("load",(()=>{x||(x=!0,R())}),p),v.addEventListener("error",(()=>{x||(x=!0,v.src="./rss_placeholder.png",R())}),p);break;case"text":var k=document.createElement("div");k.setAttribute("class","text-container");var A=k.appendChild(document.createElement("p"));if(A.setAttribute("class","default-text-style"),i){var L=i.split(";");for(var T of L)if(T){var I=T.split(":");I[0]&&I[1]&&(A.style[I[0].trim()]=I[1].trim())}}A.innerHTML=d,y[e]=document.body.appendChild(k),setTimeout((()=>{R()}),1);break;case"video":if(y[e]=document.createElement(o),y[e].setAttribute("src",d),l?y[e].muted=!0:y[e].volume=g.audioVolume,s&&y[e].setAttribute("loop","loop"),null!==r){var V=document.createElement("div");V.setAttribute("class","text-on-image"),V.innerHTML=r,h[e]=V}else h[e]=null;y[e].addEventListener("loadedmetadata",(()=>{0!==c&&(y[e].currentTime=c),y[e].addEventListener("ended",(()=>{s||(B("MEDIA_ENDED",{path:d,zone:e},n),y[e].src="")}),p),y[e].addEventListener("error",(e=>{}),p),R()}),p);break;case"audio":H(),(E=new Audio).setAttribute("src",d),l?E.muted=!0:E.volume=g.audioVolume,s?E.setAttribute("loop","loop"):E.removeAttribute("loop"),E.play(),E.addEventListener("loadedmetadata",(()=>{E.currentTime=c,E.addEventListener("ended",(()=>{s||(B("MEDIA_ENDED",{path:d,zone:e},n),E.src="")}),p),E.addEventListener("error",(()=>{B("MEDIA_ERROR",{path:d,zone:e},n)}),p)}),p);break;default:y[e]=document.body.appendChild(document.createElement("iframe")),"pdf"===o?y[e].setAttribute("src",d.trim()+"#page=1&view=Fit&toolbar=0&statusbar=0&messages=0&navpanes=0&scrollbar=0"):(y[e].setAttribute("src",d),y[e].setAttribute("sandbox","allow-forms allow-scripts allow-same-origin allow-modals"),y[e].setAttribute("allow","autoplay; fullscreen")),y[e].setAttribute("scrolling","no"),y[e].frameBorder=0,y[e].width="100%",y[e].height="100%",y[e].addEventListener("load",(()=>{R()}),p)}},P=function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8;if(x.length&&o>0)return console.log("delaying setZones to complete previous one ".concat(JSON.stringify(t).slice(0,50))),void setTimeout((()=>{o--,e(t,n,o)}),500);for(var a of("undefined"!==t.fullscreen&&(g.fullscreen=t.fullscreen),x.length=0,v))t[a]&&("audio"!==t[a].type&&x.push(a),O(a,t[a],n));0===(C=x.length)?T():(clearTimeout(D),D=setTimeout(V,3e3))},H=()=>(E.pause(),null),M=10,S=()=>{var e=t=>{console.log("Restarting the websocket due to event, ".concat(t)),u&&(u.removeEventListener("close",e,!1),u.close()),M>0?setTimeout((function(){console.log("Retsarting websocket connection,".concat(M)),M--,S()}),1e3):console.log("websocket error, giving up retrying")},t=new URLSearchParams(window.location.search),n=parseInt(t.get("screen")||0);console.log("Screen index: "+n),(u=new WebSocket("ws://127.0.0.1:".concat(r.BROWSER_WS[n]))).onopen=()=>{M=0;var e=t.get("token")?parseInt(t.get("token")):null;B("LOAD_FINISH",{path:window.location.pathname,query:window.location.search},e)},u.onmessage=t=>{var n=null;try{n=JSON.parse(t.data)}catch(e){return void console.error("Unable to parse message from chrome socket, ".concat(t.data))}var o,{cmd:a,params:r,token:i}=n,c=null;switch(a){case"uri":return u.removeEventListener("close",e,!1),u.close(),void(window.location.href="".concat(r,"&token=").concat(i));case"config":c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(void 0!==e.animationType){var t=-1!==Object.keys(p).indexOf(e.animationType)?e.animationType:"none";for(var n of(g.animationType=t,v))b[n].classList.toggle("transition-enable","none"!==t),b[n].classList.toggle("transition-disable","none"===t)}if(void 0!==e.signageBackgroundColor&&(g.signageBackgroundColor=e.signageBackgroundColor,document.body.style.backgroundColor=e.signageBackgroundColor),void 0!==e.urlReloadDisable&&(g.urlReloadDisable=e.urlReloadDisable),void 0!==e.fitImage){var o=parseInt(e.fitImage);for(var a of(g.fitImage=o,v))b[a].classList.toggle("scale-down-image",0===o),b[a].classList.toggle("contain-image",1===o),b[a].classList.toggle("fill-image",0!==o&&1!==o)}if(void 0!==e.videoKeepAspect)for(var r of(g.videoKeepAspect=e.videoKeepAspect,v))b[r].classList.toggle("contain-video",!0===g.videoKeepAspect),b[r].classList.toggle("fill-video",!0!==g.videoKeepAspect);if(void 0!==e.portrait){var i=parseInt(e.portrait);if(g.portrait=i,i&&0!==i)if(A(window.innerHeight,window.innerWidth),90===i){var l=(window.innerWidth-window.innerHeight)/2,s=(window.innerHeight-window.innerWidth)/2;document.body.style.transform="translate(".concat(l,"px, ").concat(s,"px) rotate(90deg)")}else{var c=(window.innerWidth-window.innerHeight)/2,d=(window.innerHeight-window.innerWidth)/2;document.body.style.transform="translate(".concat(c,"px, ").concat(d,"px) rotate(-90deg)")}else A(window.innerWidth,window.innerHeight)}}(r);break;case"clearZone":o=r.zone,c=void(b[o]&&(b[o].uri=null,L(b[o]),h[o]=null));break;case"clearZoneAll":c=(()=>{for(var e of v)b[e].uri=null,L(b[e]),h[e]=null})();break;case"configTicker":c=s(r);break;case"configClock":c=function(e){var t,n,o,{enable:a,position:r,format:i}=e,s=i&&0===i.indexOf("12"),c=i&&i.indexOf("d")>=0,d=document.getElementById("clock"),u=e=>e<10?"0".concat(e):"".concat(e),p=()=>{var e=new Date,t=u(e.getMinutes()),n=e.getDate(),o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][e.getMonth()],a=e.getHours();!0===s&&0==(a%=12)&&(a=12),a=u(a),d.innerHTML=(!0===c?"".concat(n," ").concat(o," "):"")+"".concat(a,":").concat(t),l=setTimeout(p,5e3)};clearTimeout(l),!0===a?(r&&"top"===r?(d.style.top=0,d.style.removeProperty("bottom")):(d.style.bottom=0,d.style.removeProperty("top")),d.style.fontSize=(t=screen.width,n=screen.height,(o=t>n?n:t)<=720?"30px":o<=1280?"50px":"70px"),d.style.display="inline",p()):d.style.display="none"}(r);break;case"configLogo":c=(e=>{var{logo:t,logox:n,logoy:o}=e,a=document.getElementById("logo");null==t?(a.style.display="none",a.src=null):(a.style.left=n+"px",a.style.top=o+"px",a.src=t,a.style.display="inline")})(r);break;case"configEMsg":c=(e=>{var{enable:t,msg:n,hPos:o,vPos:a}=e,r=document.getElementById("emessage"),i="middle"===o?"center":"left"===o?"flex-start":"flex-end",l="middle"===a?"center":"top"===a?"flex-start":"flex-end";!0===t?(r.style.justifyContent=i,r.style.alignItems=l,r.innerHTML="<span>".concat(n,"</span>"),r.style.display="flex",r.style.fontSize=(()=>{var e=screen.width,t=screen.height,n=e>t?t:e;return n<=720?"50px":n<=1280?"70px":"90px"})()):(r.style.display="none",r.innerHTML=null)})(r);break;case"setZones":c=P(r,i);break;case"playPauseVideo":c=function(){var e=y[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main"];return e&&"VIDEO"===e.tagName?(e.paused?e.play():e.pause(),null):"DOM element is not of media type"}(r.zone);break;case"stopVideo":c=function(){var e=y[arguments.length>0&&void 0!==arguments[0]?arguments[0]:"main"];return e&&"VIDEO"===e.tagName?(e.currentTime>0&&!e.paused&&!e.ended&&e.readyState>2&&e.pause(),null):"DOM element is not of media type"}(r.zone);break;case"playPauseAudio":r.zone,E.paused?E.play():E.pause(),c=null;break;case"stopAudio":c=H(r.zone);break;default:c="Unknown Command: ".concat(a),console.log("Unknown browser command: "+a)}n.error=c,B("COMMAND_EXECUTED",n,i)},u.addEventListener("close",e,!1),u.addEventListener("error",e,!1)},B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;u&&1===u.readyState?u.send(JSON.stringify({event:e,params:t,token:n})):console.log("ws could not send message")};function z(e,t,n,o,a,r,i){try{var l=e[r](i),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(o,a)}function W(e){return function(){var t=this,n=arguments;return new Promise((function(o,a){var r=e.apply(t,n);function i(e){z(r,o,a,i,l,"next",e)}function l(e){z(r,o,a,i,l,"throw",e)}i(void 0)}))}}window.onload=W((function*(){yield o(100).promise,k(),S(),document.addEventListener("keydown",(e=>{var t=null;switch(e.code){case"KeyF":case"ArrowRight":t="forward";break;case"KeyB":case"ArrowLeft":t="backward";break;case"KeyP":case"ArrowUp":case"ArrowDown":t="pause"}null!==t&&B("PLAYLIST_CMD",t)}))})),window.onerror=(e,t,n,o,a)=>{console.log(e),B("BROWSER_PAGE_ERROR",{message:e,source:t,lineno:n,colno:o,error:a})}})();</script></body></html>